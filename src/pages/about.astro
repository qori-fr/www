---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';
import { getAboutData } from '../data/about';

const lang = 'es';
const pages = await getCollection('pages');
const page = pages.find((p) => p.data.path === 'about' && p.data.lang === lang);
if (!page) throw new Error('About page not found');
const { Content } = await page.render();
const aboutData = getAboutData(lang);
---

<BaseLayout title={page.data.title} lang={lang} isHome={false} pageTitle={page.data.title}>
  <section class="section">
    <div class="container">
      <div class="row">
        <div class="col-12">
          <div class="content">
            {page.data.image && (
              <img
                class="img-fluid mb-4 w-100"
                src={encodeURI(page.data.image.startsWith('/') ? page.data.image : `/${page.data.image}`)}
                alt={page.data.title}
              />
            )}
            <Content />
          </div>
        </div>
      </div>
    </div>
  </section>
  {aboutData.success_story.enable && (
    <section class="section bg-gray" style={`background-image: url('${aboutData.success_story.bg_image}')`}>
      <div class="container">
        <div class="row">
          <div class="col-12">
            <h2 class="section-title">{aboutData.success_story.title}</h2>
            <p class="mb-4" set:html={aboutData.success_story.content.replace(/\n/g, '<br />')} />
          </div>
        </div>
      </div>
    </section>
  )}
  {aboutData.teachers.enable && (
    <section class="section">
      <div class="container">
        <div class="row">
          <div class="col-12">
            <h2 class="section-title">{aboutData.teachers.title}</h2>
          </div>
        </div>
      </div>
    </section>
  )}
</BaseLayout>
